# Week 2.3 Lesson: Security Monitoring & Defence


<img src="Crystal_Ball_Angels.png" height="300">


## Learning Objectives
By the end of this lesson, you will be able to:
- Implement continuous security monitoring techniques
- Set up automated threat detection systems
- Respond appropriately to security incidents
- Apply defence-in-depth security principles
- Connect monitoring data to actionable security improvements

---

## From Detection to Protection

### Building on Previous Weeks

**Week 2.1**: You learned to identify threats manually  
**Week 2.2**: You mastered professional vulnerability scanning  
**Week 2.3**: Now you'll automate ongoing protection

**The Evolution**: One-time scans â†’ Continuous monitoring â†’ Automated response

---

## The Security Operations Mindset

### Traditional vs Modern Defence

**âŒ Old Way: "Set and Forget"**
- Install firewall, assume you're safe
- Check security once per year
- React after attacks happen

**âœ… Modern Way: "Continuous Vigilance"**
- Monitor networks 24/7 for threats
- Detect attacks in progress
- Respond automatically to common incidents

---

## Core Monitoring Concepts

### 1. Log Analysis - Reading the Digital Footprints

Every system creates logs - records of what happened and when. Think of logs like security camera footage for your network.

#### What Logs Tell You

**Connection Logs**: Who connected and when
```
Aug 24 14:30:22 ssh: Login attempt from 203.45.67.89 (failed)
Aug 24 14:30:24 ssh: Login attempt from 203.45.67.89 (failed)  
Aug 24 14:30:26 ssh: Login attempt from 203.45.67.89 (failed)
```
**Pattern Recognition**: Multiple failed attempts = potential brute force attack

**Service Logs**: What applications are doing
```
Aug 24 14:35:10 apache: GET /admin.php from 192.168.1.50
Aug 24 14:35:12 apache: POST /admin.php from 192.168.1.50 (404 error)
```
**Pattern Recognition**: Someone looking for admin interfaces

### 2. Network Traffic Analysis - Watching the Flow

Monitor data flowing through your network to detect suspicious patterns.

#### Normal vs Suspicious Traffic

**Normal Patterns**: Business hours web browsing, regular email and file access  
**Suspicious Patterns**: Large data transfers at 3am, connections to unknown IPs, unusual ports active

**Your Week 1 Knowledge Applied**: Remember `traceroute`? Security teams use this to detect traffic going to unexpected destinations and verify network paths haven't been hijacked.

### 3. Intrusion Detection Systems (IDS)

Automated systems that watch for attack patterns and alert security teams.

#### How IDS Works

**Signature-based Detection**: Looks for known attack patterns  
**Anomaly-based Detection**: Notices unusual behaviour

**Real IDS Example**: Darktrace AI monitors network traffic, learns what's "normal" for each device, and alerts when devices act unusually.

---

## Automated Response Systems

### Beyond Just Alerting

Modern security systems don't just detect - they respond automatically.

**Automated Blocking**: System detects brute force SSH attempts â†’ automatically blocks the attacking IP  
**Traffic Shaping**: Unusual outbound data detected â†’ limits bandwidth to slow potential theft  
**System Isolation**: Malware detected â†’ automatically disconnects device from network

**Australian Example**: Commonwealth Bank automatically blocks suspicious transactions and sends SMS verification - stopping fraud before completion.

---

## Security Monitoring Layers

### Defence in Depth Strategy

Think of security like protecting a castle with multiple barriers:

**Layer 1: Firewall** - Blocks malicious traffic (castle walls)  
**Layer 2: Network IDS** - Monitors traffic inside network (patrol guards)  
**Layer 3: Endpoint Protection** - Protects individual devices (building guards)  
**Layer 4: Application Security** - Protects specific services (bodyguards)  
**Layer 5: Data Encryption** - Protects information if everything else fails (locked vault)

### Why Multiple Layers Matter

**Case Study: 2022 Medibank Ransomware Attack**

**Background**: Medibank is Australia's largest health insurer, holding sensitive medical records for 3.9 million customers and personal data for another 5.8 million past customers. In October 2022, cybercriminals infiltrated their network using stolen credentials from a third-party vendor. The attackers moved through Medibank's systems undetected for weeks, accessing customer names, addresses, birth dates, and highly sensitive health information including mental health records, pregnancy details, and chronic conditions.

**How Defence Layers Failed**:
* **Layer 1 (Firewall)**: Bypassed via legitimate credentials from compromised vendor
* **Layer 2 (Network Monitoring)**: Failed to detect lateral movement quickly enough  
* **Layer 3 (Endpoint Protection)**: Didn't identify unusual data access patterns
* **Layer 4 (Application Security)**: Insufficient access controls between systems
* **Layer 5 (Data Encryption)**: Customer data accessible in readable format

**Result**: 9.7 million customer records stolen, $100+ million in costs, massive reputational damage

**Lesson**: One defensive failure can expose entire network - need multiple layers working together.

---

## Incident Response Process

### When Bad Things Happen

**The 5 Phases of Incident Response:**

**Phase 1: Detection** - Monitoring systems alert to suspicious activity  
**Phase 2: Containment** - Isolate affected systems from network  
**Phase 3: Investigation** - Determine how attack occurred and scope of damage  
**Phase 4: Recovery** - Clean systems and restore services from backups  
**Phase 5: Lessons Learned** - Update procedures and improve monitoring

**Medibank Example**: Detection took weeks, containment required taking systems offline, investigation revealed email compromise, recovery took months, lessons led to new monitoring investments.

---

## Practical Monitoring Techniques

### 1. Continuous Scanning

**Scheduled nmap scans**: Run vulnerability scans regularly
```bash
nmap -sV localhost > daily_scan.txt
```
**Compare results**: New services? Investigate. Version changes? Check security updates.

### 2. Network Behaviour Analysis

**Using Week 1 skills for monitoring**:
- **`ping` monitoring**: Continuously test critical services
- **`ss` checking**: Regular scans for new services
- **`traceroute` verification**: Ensure network paths aren't hijacked

### Simple Development Network Monitoring

**Development servers often run on your network** with different security needs:
```bash
# Check for development services
nmap -p 3000,5000,8080,8888 localhost
ss -tuln | grep "3000\|5000\|8080"
```
**Security Question**: Should development services be accessible from the internet?

---

## Quick Check: Core Concepts

**Scenario 1**: Your monitoring detects 50 failed SSH attempts in 5 minutes.
- **Attack type and response?** `_________________`

**Scenario 2**: Device starts communicating with unknown servers at 2am.
- **Investigation priority and tools?** `_________________`

**Scenario 3**: New service appears on port 8080 without authorisation.
- **Risk assessment and next steps?** `_________________`

<details>
<summary>Click for answers</summary>

**Scenario 1**: Brute force attack - auto-block IP, check if any logins succeeded  
**Scenario 2**: High priority - use `ss`, `traceroute` to investigate connections  
**Scenario 3**: Medium risk - identify service with `nmap -sV`, determine if legitimate

</details>

---

## Coming Up Next

### Week 2.3 Lab: Log Analysis & Monitoring
Practice reading security logs, setting up monitoring, and responding to incidents.

### Week 2.3 Code Practice: Automated Security Monitor
Build Python scripts for continuous threat detection and automated security reporting.

---

## Key Terms to Remember

- **Security Information and Event Management (SIEM)**: Systems that collect and analyse security logs
- **Intrusion Detection System (IDS)**: Monitors network traffic for malicious activity
- **Defence in Depth**: Multiple layers of security controls
- **Incident Response**: Systematic approach to handling security incidents
- **Log Analysis**: Examining system records to identify security events

---

## ðŸŽ“ Future Learning Connections

**Skills you're building now that connect to advanced cybersecurity study:**

**Network Security Foundation**: Understanding how monitoring actually works at the technical level provides credibility when later evaluating organisational security practices, development environment protection, and compliance frameworks.

**Professional Pathway**: These monitoring skills directly prepare you for Security Operations Centre (SOC) analyst roles, incident response positions, and cybersecurity consulting work.

**Advanced Topics**: Your foundation enables future study of AI-powered threat detection, IoT security monitoring, cloud security assessment, and organisational security analysis including software development lifecycle protection.

## Next: Week 2.3 Lab