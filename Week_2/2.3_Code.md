# Week 2.3 Code Practice: Python Security Automation

### Script 1: Python Cron Job (Scheduled Monitoring)

Create `scheduled_monitor.py`:

```python
import schedule, time, requests, datetime

def security_check():
    try:
        resp = requests.get("http://localhost:3923", timeout=2)
        print(f"‚è∞ {datetime.datetime.now():%H:%M:%S} Scheduled check: Service UP ({resp.status_code})")
    except:
        print(f"üö® {datetime.datetime.now():%H:%M:%S} ALERT: Service DOWN - Auto-restarting...")

schedule.every(30).seconds.do(security_check)
while True: schedule.run_pending(); time.sleep(1)
```

**Run:** `pip install schedule && python3 scheduled_monitor.py`

**Real-world use:** Replace cron jobs with Python for complex scheduling logic

---

### Script 2: Syslog Parser & Threat Hunter

Create `syslog_parser.py`:

```python
import re, collections
from datetime import datetime

with open('/var/log/syslog', 'r') as f: lines = f.readlines()[-50:]  # Last 50 lines
threats = collections.Counter()
for line in lines:
    if any(word in line.lower() for word in ['failed', 'invalid', 'denied', 'attack']):
        ip = re.search(r'(\d+\.\d+\.\d+\.\d+)', line)
        if ip: threats[ip.group(1)] += 1
print(f"üîç Syslog Analysis: {len(threats)} threatening IPs found")
for ip, count in threats.most_common(3):
    print(f"üö® {ip}: {count} incidents")
```

**Run:** `python3 syslog_parser.py`

**Real-world use:** Parse any log format for security incident detection

---

### Script 3: HTTP Traffic Sniffer (Copyparty Monitor)

Create `http_sniffer.py`:

```python
from scapy.all import sniff, TCP, Raw

def packet_handler(packet):
    if packet.haslayer(TCP) and packet.haslayer(Raw) and packet[TCP].dport == 8080:
        data = packet[Raw].load.decode('utf-8', errors='ignore')
        if 'GET' in data or 'POST' in data:
            print(f"üïµÔ∏è HTTP Request to copyparty: {data.split()[0:2]}")

sniff(filter="port 8080", prn=packet_handler, count=10, timeout=30)
print("üì° Traffic sniffing complete")
```

**Run:** `sudo python3 http_sniffer.py` (then access your copyparty service)

**Real-world use:** Monitor unencrypted application traffic for security analysis

---

### Script 4: File Integrity Monitor (Tamper Detection)

Create `file_guardian.py`:

```python
import hashlib, os, time

def get_hash(filepath):
    return hashlib.md5(open(filepath, 'rb').read()).hexdigest() if os.path.exists(filepath) else None

watch_files = ['~/lab_files/important.txt', '/etc/hosts']  # Add your important files
hashes = {f: get_hash(f) for f in watch_files}
time.sleep(5)  # Wait for potential changes
for file, old_hash in hashes.items():
    new_hash = get_hash(file)
    status = "üî¥ MODIFIED" if old_hash != new_hash else "‚úÖ Unchanged"
    print(f"üõ°Ô∏è {file}: {status}")
```

**Run:** `echo "test" > ~/lab_files/important.txt && python3 file_guardian.py`

**Real-world use:** Detect unauthorised file modifications, configuration tampering

---

## Why Python Beats Traditional Tools

### Cron Jobs
**Traditional cron:**
```bash
*/5 * * * * /bin/ping -c 1 google.com > /dev/null || echo "Down"
```

**Python equivalent:**
```python
schedule.every(5).minutes.do(lambda: requests.get("http://google.com"))
```
**Advantage:** Complex logic, error handling, notifications, database logging

### Syslog Analysis
**Traditional grep/awk:**
```bash
grep "failed" /var/log/syslog | awk '{print $6}' | sort | uniq -c
```

**Python equivalent:** Your `syslog_parser.py` above
**Advantage:** Pattern recognition, IP analysis, threat correlation, reporting

### Traffic Monitoring
**Traditional tcpdump:**
```bash
sudo tcpdump -i any port 3923

sudo tcpdump -i wlan0 -A port 3923
```

**Python scapy:** Your `http_sniffer.py` above
**Advantage:** Intelligent filtering, content analysis, automated response

---

## Australian Cybersecurity Applications

**üèõÔ∏è Government**: ASD uses Python for automated threat hunting in classified networks

**üè¶ Banking**: CBA's fraud detection systems use Python for real-time transaction monitoring

**üè• Healthcare**: Hospital networks use Python to monitor medical device communications

**üéì Education**: Universities use Python to detect student network policy violations

---

## Professional Security Operations

Your Python scripts demonstrate **Security Orchestration, Automation and Response (SOAR)** capabilities used by:

- **Incident Response Teams**: Automated evidence collection
- **SOC Analysts**: Continuous threat hunting  
- **DevSecOps Engineers**: Integrated security monitoring
- **Penetration Testers**: Custom reconnaissance tools

---

## Key Insight: Python's Security Advantage

**Traditional approach:** Multiple tools, complex shell scripts, manual correlation
**Python approach:** Single language, rich libraries, intelligent automation, integrated response

**Your progression:**
- Week 1: Manual network commands
- Week 2: Automated vulnerability scanning  
- Week 2.3: **Complete security operations automation**

Perfect preparation for cybersecurity careers in Australia's growing digital security industry!